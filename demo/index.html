<html>

<head>
    <!-- IE11 does support addEventListener(). Disable compatibility mode. -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Load a custom font -->
    <!-- <link href="https://fonts.googleapis.com/css?family=Caveat" rel="stylesheet"> -->
    <link href="https://fonts.googleapis.com/css?family=Khula:400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Titillium+Web:200,400" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lato:300" rel="stylesheet">
    <!-- The main js library -->
    <script src="./js/autotagjs.min.js"></script>

    <!-- Required for input area to appear correctly across browsers -->
    <link rel="stylesheet" type="text/css" href="./css/autotagjs.css">
    <link rel="stylesheet" type="text/css" href="./css/icons.css">

    <!-- Demo page styles -->
    <link rel="stylesheet" type="text/css" href="./css/demo.css">
    <link rel="stylesheet" type="text/css" href="./css/tooltip.css">

</head>

<body>
    <div class="page-header">
        <div class="page-title">AutotagJS</div>
        <div class="page-msg">
            A simple and lightweight (~5kb zipped) open source text formatter plugin
            built in plain Javascript.
        </div>
    </div>

    <div class="page-notepad">
        <div class="demo-container atg-editor">
            <div id="menubar" class="demo-menubar" data-atg-scope="selection">
                <span class="demo-menu atg-menu">
                    <span class="icon-size"></span>
                    <div style="display:none;" class="demo-submenu atg-submenu"
                        data-atg-scope="tags">
                        <div data-atg-set="font-size: 11px">8</div>
                        <div data-atg-set="font-size: 12px">9</div>
                        <div data-atg-set="font-size: 13px">10</div>
                        <div data-atg-set="font-size: 14px">11</div>
                        <div data-atg-set="font-size: 16px">12</div>
                        <div data-atg-set="font-size: 19px">14</div>
                        <div data-atg-set="font-size: 24px">18</div>
                        <div data-atg-set="font-size: 32px">24</div>
                        <div data-atg-set="font-size: 40px">30</div>
                        <div data-atg-set="font-size: 52px">40</div>
                        <div data-atg-set="font-size: 93px">70</div>
                        <div data-atg-increment="font-size: 10px">Bigger</div>
                        <div data-atg-decrement="font-size: 10px">Smaller</div>
                    </div>
                </span>

                <span class="demo-menu-sep"></span>

                <span class="icon-bold demo-menu atg-menu"
                    data-atg-scope="tags"
                    data-atg-toggle="font-weight:bold">
                </span>

                <span class="icon-italic demo-menu atg-menu"
                    data-atg-scope="tags"
                    data-atg-toggle="font-style:italic"></span>

                <span class="icon-underlined demo-menu atg-menu"
                    data-atg-scope="tags"
                    data-atg-toggle="text-decoration:underline"></span>

                <span class="demo-menu-sep"></span>

                <span class="icon-color-text demo-menu atg-menu"
                    data-atg-scope="tags"
                    data-atg-submenu="colorPalette"></span>

                <span class="icon-color-fill demo-menu atg-menu"
                    data-atg-scope="tags"
                    data-atg-submenu="highlightPalette"></span>

                <span class="demo-menu-sep"></span>

                <span class="icon-align-left demo-menu atg-menu"
                    data-atg-scope="line"
                    data-atg-set="justify-content: left; text-align: left"></span>

                <span class="icon-align-center demo-menu atg-menu"
                    data-atg-scope="line"
                    data-atg-set="justify-content: center; text-align: center"></span>

                <span class="icon-align-right demo-menu atg-menu"
                    data-atg-scope="line"
                    data-atg-set="justify-content: right; text-align: right"></span>

                <span class="icon-align-justify demo-menu atg-menu"
                    data-atg-scope="line"
                    data-atg-set="justify-content: justify; text-align: justify"></span>

                <span class="demo-menu-sep"></span>

                <span class="demo-menu atg-menu"
                    data-atg-select="line-height">
                    <span class="icon-line-spacing"></span>
                    <div style="display:none;" class="demo-submenu atg-submenu"
                        data-atg-scope="line">
                        <div data-atg-set="line-height: 1.5em">1.5</div>
                        <div data-atg-set="line-height: 1em">Normal</div>
                        <div data-atg-set="line-height: 2em">Double</div>
                        <div data-atg-set="line-height: 3em">Correction</div>
                    </div>
                </span>

                <span class="demo-menu-sep"></span>

                <span class="icon-indent-right demo-menu atg-menu"
                    data-atg-scope="line"
                    data-atg-command="indent"></span>

                <span class="icon-indent-left demo-menu atg-menu"
                    data-atg-scope="line"
                    data-atg-command="outdent"></span>

                <span class="demo-menu-sep"></span>

                <span class="demo-menu atg-menu"
                    data-atg-select="bulleted-list">
                    <span class="icon-list-bulleted"></span>
                    <div style="display:none;" class="demo-submenu atg-submenu"
                        data-atg-scope="line">
                        <div class="demo-submenu-sep"
                            data-atg-command="list clear">Clear</div>
                        <div data-atg-command="list bulletted">
                            ●&nbsp;&nbsp;○&nbsp;&nbsp;▪&nbsp;&nbsp;...
                        </div>
                    </div>
                </span>

                <span class="demo-menu atg-menu"
                    data-atg-select="numbered-list">
                    <span class="icon-list-numbered"></span>
                    <div style="display:none;" class="demo-submenu atg-submenu"
                        data-atg-scope="line">
                        <div class="demo-submenu-sep"
                            data-atg-command="list clear">Clear</div>
                        <div data-atg-command="list numbered-period">
                            1.&nbsp;a.&nbsp;i.&nbsp;...
                        </div>
                    </div>
                </span>

                <span class="demo-menu-sep"></span>

                <span class="icon-clear demo-menu atg-menu"
                    data-atg-scope="selection"
                    data-atg-command="clear"></span>
            </div>

<div id="editor" class="demo-input demo-notepad atg-textarea" contenteditable="true"><div class="atg-line" data-atg-indent-pos="0"><div class="atg-line-body"><span style="font-size: 24px;">Dec 1</span><span style="font-size: 24px;">, 1862</span><span style="font-size: 24px;"> : </span><span style="font-size: 24px; font-weight: bold;">Lincoln</span><span style="font-size: 24px; font-weight: bold;">&apos;</span><span style="font-size: 24px; font-weight: bold;">s</span><span style="font-size: 24px; font-weight: bold;">&nbsp;</span><span style="font-size: 24px; font-weight: bold;">State</span><span style="font-size: 24px; font-weight: bold;">&nbsp;</span><span style="font-size: 24px; font-weight: bold;">of</span><span style="font-size: 24px; font-weight: bold;">&nbsp;</span><span style="font-size: 24px; font-weight: bold;">the</span><span style="font-size: 24px; font-weight: bold;">&nbsp;</span><span style="font-size: 24px; font-weight: bold;">Union</span><span style="font-size: 24px; font-weight: bold;">&nbsp;</span><span style="font-size: 24px; font-weight: bold;">address</span></div></div><div class="atg-line" data-atg-indent-pos="0"><div class="atg-line-body"><span class="atg-pilot">&nbsp;</span></div></div><div class="atg-line" data-atg-indent-pos="0"><div class="atg-line-body"><span>On</span><span>&nbsp;</span><span class="demo-pronoun" data-tooltip="Pronoun">this</span><span>&nbsp;</span><span>day</span><span>&nbsp;</span><span>in</span><span>&nbsp;</span><span>1862</span><span>,&nbsp;</span><span>President</span><span>&nbsp;</span><span>Abraham</span><span>&nbsp;</span><span>Lincoln</span><span>&nbsp;</span><span>addresses</span><span>&nbsp;</span><span>the</span><span>&nbsp;</span><span>U</span><span>.</span><span>S</span><span>.&nbsp;</span><span>Congress</span><span>&nbsp;</span><span>and</span><span>&nbsp;</span><span>speaks</span><span>&nbsp;</span><span>some</span><span>&nbsp;</span><span>of</span><span>&nbsp;</span><span class="demo-pronoun" data-tooltip="Pronoun">his</span><span>&nbsp;</span><span>most</span><span>&nbsp;</span><span>memorable</span><span>&nbsp;</span><span>words</span><span>&nbsp;</span><span>as</span><span>&nbsp;</span><span class="demo-pronoun" data-tooltip="Pronoun">he</span><span>&nbsp;</span><span>discusses</span><span>&nbsp;</span><span>the</span><span>&nbsp;</span><span>Northern</span><span>&nbsp;</span><span>war</span><span>&nbsp;</span><span>effort</span><span>.</span></div></div><div class="atg-line" data-atg-indent-pos="0"><div class="atg-line-body"><span class="atg-pilot">&nbsp;</span></div></div><div class="atg-line" data-atg-indent-pos="0"><div class="atg-line-body"><span>Lincoln</span><span>&nbsp;</span><span>used</span><span>&nbsp;</span><span>the</span><span>&nbsp;</span><span>address</span><span>&nbsp;</span><span>to</span><span>&nbsp;</span><span>present</span><span>&nbsp;</span><span>a</span><span>&nbsp;</span><span>moderate</span><span>&nbsp;</span><span>message</span><span>&nbsp;</span><span>concerning</span><span>&nbsp;</span><span class="demo-pronoun" data-tooltip="Pronoun">his</span><span>&nbsp;</span><span>policy</span><span>&nbsp;</span><span>towards</span><span>&nbsp;</span><span>slavery</span><span>.&nbsp;</span><span>Just10</span><span>&nbsp;</span><span>weeks</span><span>&nbsp;</span><span>before</span><span>,&nbsp;</span><span class="demo-pronoun" data-tooltip="Pronoun" style="background-color: rgb(158, 254, 134);">he</span><span style="background-color: rgb(158, 254, 134);">&nbsp;</span><span style="background-color: rgb(158, 254, 134);">had</span><span style="background-color: rgb(158, 254, 134);">&nbsp;</span><span style="background-color: rgb(158, 254, 134);">issued</span><span style="background-color: rgb(158, 254, 134);">&nbsp;</span><span class="demo-pronoun" data-tooltip="Pronoun" style="background-color: rgb(158, 254, 134);">his</span><span style="background-color: rgb(158, 254, 134);">&nbsp;</span><span style="background-color: rgb(158, 254, 134);">Emancipation</span><span style="background-color: rgb(158, 254, 134);">&nbsp;</span><span style="background-color: rgb(158, 254, 134);">Proclamation</span><span style="background-color: rgb(158, 254, 134);">,</span><span>&nbsp;</span><span class="demo-pronoun" data-tooltip="Pronoun">which</span><span>&nbsp;</span><span style="font-weight: bold; font-style: italic;">declared</span><span>&nbsp;</span><span class="demo-pronoun" data-tooltip="Pronoun">that</span><span>&nbsp;</span><span>slaves</span><span>&nbsp;</span><span>in</span><span>&nbsp;</span><span>territories</span><span>&nbsp;</span><span>still</span><span>&nbsp;</span><span>in</span><span>&nbsp;</span><span>rebellion</span><span>&nbsp;</span><span>as</span><span>&nbsp;</span><span>of</span><span>&nbsp;</span><span>January</span><span>&nbsp;</span><span>1</span><span>,&nbsp;</span><span>1863</span><span>,&nbsp;</span><span>would</span><span>&nbsp;</span><span>be</span><span>&nbsp;</span><span>free</span><span>.&nbsp;</span><span>The</span><span>&nbsp;</span><span>measure</span><span>&nbsp;</span><span>was</span><span>&nbsp;</span><span>not</span><span>&nbsp;</span><span>welcomed</span><span>&nbsp;</span><span>by</span><span>&nbsp;</span><span class="demo-pronoun" data-tooltip="Pronoun">everyone</span><span>&nbsp;</span><span>in</span><span>&nbsp;</span><span>the</span><span>&nbsp;</span><span>North</span><span>–</span><span class="demo-pronoun" data-tooltip="Pronoun">it</span><span>&nbsp;</span><span>met</span><span>&nbsp;</span><span>with</span><span>&nbsp;</span><span>considerable</span><span>&nbsp;</span><span>resistance</span><span>&nbsp;</span><span>from</span><span>&nbsp;</span><span>conservative</span><span>&nbsp;</span><span>Democrats</span><span>&nbsp;</span><span class="demo-pronoun" data-tooltip="Pronoun">who</span><span>&nbsp;</span><span>did</span><span>&nbsp;</span><span>not</span><span>&nbsp;</span><span>want</span><span>&nbsp;</span><span>to</span><span>&nbsp;</span><span>fight</span><span>&nbsp;</span><span>a</span><span>&nbsp;</span><span>war</span><span>&nbsp;</span><span>to</span><span>&nbsp;</span><span>free</span><span>&nbsp;</span><span>slaves</span><span>.</span></div></div><div class="atg-line" data-atg-indent-pos="0"><div class="atg-line-body"><span class="atg-pilot">&nbsp;</span></div></div><div class="atg-line" data-atg-indent-pos="0"><div class="atg-line-body"><span class="atg-pilot">&nbsp;</span></div></div><div class="atg-line" data-atg-indent-pos="0"><div class="atg-line-body"><span class="atg-pilot">&nbsp;</span></div></div></div>
        </div>
    </div>

    <div class="page-section section-build-editor">
        <div class="section-text">
            <div class="section-text-title">
                Build Your Own Text Editor
            </div>
            <div class="section-text-body">
                autotag.js provides a simple and intuitive way to apply custom
                formatting to text under the cursor.
            </div>
        </div>
        <div class="section-image ">
            <img class="editor-image" src="./images/editor.png"/>
        </div>
    </div>

    <div class="page-section section-enhanced-input">
        <div class="section-form">
            <div class="demo-inputplus-label">
                Title
            </div>
            <div id="textbox" class="demo-inputplus demo-inputplus-textbox" contenteditable="true"><div class="atg-line" data-atg-indent-pos="0"><div class="atg-line-body"><span style="" class="atg-text">autotagjs</span><span style="" class="atg-text"> </span><span style="" class="atg-text">is</span><span style="" class="atg-text"> </span><span style="" class="atg-text demo-hash-tag">#awesome</span><span style="" class="atg-text">!</span></div></div></div>
            <div class="demo-inputplus-label">
                Description
            </div>
            <div id="textarea" class="demo-inputplus demo-inputplus-textarea" contenteditable="true"><div class="atg-line" data-atg-indent-pos="0"><div class="atg-line-body"><span style="" class="atg-text">Try</span><span style="" class="atg-text"> </span><span style="" class="atg-text demo-pronoun" data-tooltip="Pronoun">it</span><span style="" class="atg-text"> </span><span style="" class="atg-text">on</span><span style="" class="atg-text"> </span><span style="" class="atg-text demo-pronoun" data-tooltip="Pronoun">your</span><span style="" class="atg-text"> </span><span style="" class="atg-text demo-plus-sign">+project</span><span style="" class="atg-text"> </span><span style="" class="atg-text demo-hash-tag">#today</span><span style="" class="atg-text">.</span><span style="" class="atg-text"> </span></div></div></div>
        </div>
        <div class="section-text">
            <div class="section-text-title">
                Supercharge your forms
            </div>
            <div class="section-text-body">
                Highlight hashtags, validate text or perform other operation on
                user input with less code.
            </div>
        </div>
    </div>


    <div class="page-section section-browser-support">
        <div class="section-text">
            <div class="section-text-title">
                Supports all major browsers
            </div>
            <div class="section-text-body">
                AutotagJS works on all webkit based browsers (Chrome, Safari,
                Vivaldi), Firefox and (perhaps) Edge, on desktops and mobile devices.
            </div>
        </div>

        <div class="section-image ">
            <table class="browser-icon-list">
                <tr>
                    <td class="browser-icon icon-chrome"></td>
                    <td class="browser-icon icon-safari"></td>
                </tr>
                <tr>
                    <td class="browser-icon icon-firefox"></td>
                    <td class="browser-icon icon-edge"></td>
                </tr>
            </table>
        </div>
    </div>

    <script type="text/javascript">

            // A list of pronouns we want highlighted in the editor. Note that this
            // is just for demonstration purposes only and is not a part of the plugin.
            var pronouns = [
                'your', 'I', 'they', 'their', 'we', 'who', 'them', 'its', 'our', 'my',
                'those', 'he', 'us', 'her', 'something', 'me', 'yourself', 'someone',
                'everything', 'itself', 'everyone', 'themselves', 'anyone', 'him',
                'whose', 'myself', 'everybody', 'ourselves', 'himself', 'somebody',
                'yours', 'herself', 'whoever', 'you', 'that', 'it', 'this', 'what',
                'which', 'these', 'his', 'she', 'lot', 'anything', 'whatever', 'nobody',
                'none', 'mine', 'anybody'
            ];

            // The element that we use as the editor in design mode.
            var editor = document.getElementById('editor');

            // We will build a menubar for the editor. Note that the plugin does not
            // provide a default menubar. This is intentional.
            var menubar = document.getElementById('menubar');

            // All the code from here until the configuration options are required to
            // highlight the appropriate menu item that correspnds to the style of
            // the text or selection in the editor.
            var getMenuClassList = function(className) {
                return menubar.getElementsByClassName(className)[0].classList;
            };

            var boldMenuClassList = getMenuClassList('icon-bold');
            var italicMenuClassList = getMenuClassList('icon-italic');
            var underlinedMenuClassList = getMenuClassList('icon-underlined');

            var textColorIcon =
                menubar.getElementsByClassName('icon-color-text')[0];
            var fillColorIcon =
                menubar.getElementsByClassName('icon-color-fill')[0];

            var setMenuIconState = function(classList, isActive) {
                if (classList) {
                    if (isActive) {
                        classList.add('demo-menu-active');
                    } else {
                        classList.remove('demo-menu-active');
                    }
                }
            };


            var isBold = function(fragment) {
                return fragment.style.getPropertyValue('font-weight') == 'bold';
            };

            var isItalic = function(fragment) {
                return fragment.style.getPropertyValue('font-style') == 'italic';
            };

            var isUnderlined = function(fragment) {
                return fragment.style.getPropertyValue('text-decoration') == 'underline';
            };

            // Some configuration options for the editor.
            var editorConfig = {
                // The splitter returns an index at which the text should
                // be split. We can later use the split fragments to apply
                // custom styles via the decorator callback.
                splitter: function(text) {
                    let match;
                    if ((match = text.match(/((?<=^\w+)\W$)|((?<=\W+)\w$)/))) {
                        return match.index;
                    }
                },

                // A callback that gets called when the splitter
                decorator: function(nodes) {
                    // The splitter above splits the text at the point it
                    // detects a word boundary.
                    let node = nodes[0];
                    if (node) {
                        node = node.parentNode;
                        let text = node.textContent.toLowerCase();
                        let classList = node.classList;

                        if (pronouns.indexOf(text) >= 0) {
                            classList.add('demo-pronoun');
                            node.setAttribute('data-tooltip', 'Pronoun');
                        }
                        else {
                            // Always remember to clean the node!
                            classList.remove('demo-pronoun');
                            node.removeAttribute('data-tooltip');
                        }
                    }
                },

                // Every caret move or selction change, a call is made to the function.
                // In this demo, we use the callback to highlight the Bold, Italic & Underline menus
                // if the style is applied to the text under the caret or selection.
                afterSelection: function(fragments) {
                    let fragment;
                    if (fragments.length == 1 && (fragment = fragments[0])) {
                        fragment = fragment.parentNode;
                        setMenuIconState(boldMenuClassList, isBold(fragment));
                        setMenuIconState(italicMenuClassList, isItalic(fragment));
                        setMenuIconState(underlinedMenuClassList, isUnderlined(fragment));

                        // Other icons
                        textColorIcon.style.color = fragment.style.color;
                        fillColorIcon.style.color = fragment.style.backgroundColor;
                    }
                },

                onMenuClick: function(message, nodes) {
                    // if (message == 'num-list') {
                    //  Do somethning with the nodes returned
                    // }
                },

                // Set to true for debugging.
                trace: false,

                // You can disable the return key in the editor by setting this to true.
                ignoreReturnKey: false
            };

            // Enable the editor element with the provided config and attach the menubar.
            new AutotagJS(editor, editorConfig).attachMenubar(menubar);

            var inputConfig = {
                // The splitter returns an index at which the text should
                // be split. We can later use the split fragments to apply
                // custom styles via the decorator callback.
                splitter: function(text) {
                    let match;
                    if ((match = text.match(/((?<=^[#\+\@]\w{2,})\W$)|([#\+\@]\w{2}$)/))) {
                        return match.index;
                    }
                },

                // The splitter splits the text at the point it
                // detects a '#', '@', or '+'.
                // Eg. "Hello #yo" => ["Hello ", "#yo"]
                decorator: function(nodes) {
                    let node = nodes[1];
                    if (node) {
                        node = node.parentNode;
                        let text = node.textContent;
                        var classList = node.classList;
                        if (text.match(/^#[\w]{2}[\w]*$/)) {
                            classList.add('demo-hash-tag');
                        }
                        else if (text.match(/^[\+][\w]{2}[\w]*$/)) {
                            classList.add('demo-plus-sign');
                        }
                        else if (text.match(/^[\@][\w]{2}[\w]*$/)) {
                            classList.add('demo-at-tag');
                        }
                        else {
                            classList.remove('demo-hash-tag');
                            classList.remove('demo-at-tag');
                            classList.remove('demo-plus-sign');
                        }
                    }
                },
                ignoreReturnKey: true
            };

            new AutotagJS(document.getElementById('textbox'), inputConfig);
            new AutotagJS(document.getElementById('textarea'), inputConfig);
    </script>
</body>

</html>
